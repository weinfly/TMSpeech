# TMSpeech 编译指南

## 前置条件

在编译前，请确保您已经安装了 .NET 6.0 SDK。您可以从 [Microsoft 官网](https://dotnet.microsoft.com/zh-cn/download/dotnet/6.0) 下载并安装。

## 编译步骤

### 1. 克隆项目

如果您还没有克隆项目，请先克隆：

```bash
git clone https://github.com/your-username/TMSpeech.git
cd TMSpeech
```

### 2. 编译整个解决方案

在项目根目录下运行以下命令，编译整个解决方案：

```bash
dotnet build -c Release
```

### 3. 发布主程序为可执行文件

进入主项目目录并发布：

```bash
cd src/TMSpeech
dotnet publish -c Release -o publish
```

发布完成后，可执行文件将生成在 `src/TMSpeech/publish` 目录下。

### 4. 运行程序

编译完成后，您可以直接运行发布目录下的 `TMSpeech.exe` 文件：

```bash
./publish/TMSpeech.exe
```

## 编译选项说明

- `-c Release`: 指定编译配置为 Release，优化生产环境性能
- `-o publish`: 指定发布输出目录为 `publish`

## 清理编译产物

如果您需要清理编译产物，可以运行以下命令：

```bash
# 清理整个解决方案
dotnet clean -c Release

# 清理主项目
dotnet clean -c Release src/TMSpeech
```

## 常见问题

### 1. 编译失败，提示缺少依赖

请确保您已经安装了正确版本的 .NET SDK，并尝试运行以下命令恢复依赖：

```bash
dotnet restore
```

### 2. 发布后缺少插件

确保您在编译前已经获取了所有必要的插件。默认情况下，插件会在编译时自动生成到发布目录的 `plugins` 文件夹中。

### 3. 运行时提示缺少 DLL 文件

请确保您是从发布目录运行程序，而不是从编译输出目录运行。发布目录包含了所有必要的依赖文件。

## 目录结构说明

```
TMSpeech/
├── src/
│   ├── TMSpeech/               # 主项目目录
│   │   ├── TMSpeech.csproj      # 主项目配置文件
│   │   └── publish/             # 发布输出目录
│   ├── TMSpeech.Core/           # 核心库项目
│   ├── TMSpeech.GUI/            # GUI 项目
│   └── Plugins/                 # 插件项目
│       ├── TMSpeech.AudioSource.Windows/     # Windows 音频源插件
│       ├── TMSpeech.Recognizer.SherpaOnnx/    # Sherpa Onnx 语音识别插件
│       └── TMSpeech.Translator.OpenAI/        # OpenAI 翻译插件
└── TMSpeech.sln                 # 解决方案文件
```

## 注意事项

1. 编译和发布命令需要在命令行工具中运行（如 PowerShell、CMD 或 Terminal）
2. 确保您的网络连接正常，以便恢复依赖和下载必要的资源
3. 编译时间可能因电脑性能而异，一般需要 1-5 分钟
4. 发布后的可执行文件可以直接复制到其他电脑上运行，无需安装 .NET SDK

## 更新日志

- 2025-12-02: 初始版本，包含基本编译和发布命令

---

希望这份编译指南对您有所帮助！如果您在编译过程中遇到任何问题，请查看项目的 README 文件或提交 Issue。